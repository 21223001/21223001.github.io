<!-- edit.html -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>手動で修正</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f8f9fa;
    }
    .toolbar {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }
    .toolbar button {
      padding: 10px 15px;
      border: none;
      border-radius: 5px;
      background-color: #007bff;
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .toolbar button:hover {
      background-color: #0056b3;
    }
    .preview-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .preview-content {
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      max-width: 90%;
      max-height: 90%;
      overflow: auto;
    }
    .close-modal {
      margin-top: 10px;
      padding: 5px 10px;
      background-color: #dc3545;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .close-modal:hover {
      background-color: #c82333;
    }
    /* 編集可能なセクション */
    .editable {
      border: 2px dashed #007bff;
      padding: 10px;
      margin-bottom: 20px;
      background-color: #ffffff;
      border-radius: 5px;
      cursor: move; /* ドラッグ可能であることを示すカーソル */
    }
    .editable:focus {
      outline: none;
      border-color: #0056b3;
    }
    /* ドラッグ中のスタイル */
    .sortable-ghost {
      opacity: 0.4;
    }
  </style>
  <!-- SortableJSの導入 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js" integrity="sha512-9YqmLhg/ivgNZQFvIhi6hM5lWk3TQ6PTC9x0P3He3RfP9kSXh3pBtcafJ4wYFv+3yrzNdqHHN9jyqfJpcBtbmw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
  <h2>手動で修正</h2>
  
  <div class="toolbar">
    <button onclick="previewChanges()">プレビュー</button>
    <button onclick="saveChanges()">修正を確定</button>
  </div>
  
  <!-- 編集可能なコンテナ -->
  <div id="editable-content">
    <div class="editable" contenteditable="true">
      <h1>研究室情報一覧</h1>
    </div>
    
    <div class="editable" contenteditable="true">
      <h2>目次</h2>
      <ul>
        <li><a href="#lab-13">New Research Lab: xcv</a></li>
        <!-- 他の研究室リンクがあればここに追加 -->
      </ul>
    </div>
    
    <div class="editable" contenteditable="true" id="lab-13">
      <h2>New Research Lab: xcv</h2>
      
      <!-- Lab Name セクション -->
      <div class="editable section">
        <div class="section-title">Lab Name</div>
        <div class="section-content">xcv</div>
      </div>

      <!-- Introduction セクション -->
      <div class="editable section">
        <div class="section-title">Introduction</div>
        <div class="section-content">xcvの研究室です。</div>
      </div>

      <!-- Research Themes セクション -->
      <div class="editable section">
        <div class="section-title">Research Themes</div>
        <div class="section-content">xcvの研究テーマ</div>
      </div>

      <!-- Seminar Frequency セクション -->
      <div class="editable section">
        <div class="section-title">Seminar Frequency</div>
        <div class="section-content">週２回</div>
      </div>

      <!-- Lab Atmosphere セクション -->
      <div class="editable section">
        <div class="section-title">Lab Atmosphere</div>
        <div class="section-content">コアタイムなし</div>
      </div>

      <!-- Research Fields セクション -->
      <div class="editable section">
        <div class="section-title">Research Fields</div>
        <div class="section-content">系統分類学</div>
      </div>
    </div>
  </div>
  
  <!-- プレビューモーダル -->
  <div class="preview-modal" id="preview-modal">
    <div class="preview-content" id="preview-content">
      <!-- プレビュー内容がここに表示されます -->
    </div>
    <button class="close-modal" onclick="closePreview()">閉じる</button>
  </div>
  
  <script>
    // プレビュー表示
    function previewChanges() {
      const editableContent = document.getElementById('editable-content').innerHTML;
      const previewContent = document.getElementById('preview-content');
      previewContent.innerHTML = editableContent;
      document.getElementById('preview-modal').style.display = 'flex';
    }
    
    // プレビュー閉じる
    function closePreview() {
      document.getElementById('preview-modal').style.display = 'none';
    }
    
    // 修正を確定して保存
    function saveChanges() {
      const editableContent = document.getElementById('editable-content').innerHTML;
      
      // 確認ダイアログ
      const confirmSave = confirm('修正を確定して保存しますか？');
      if (!confirmSave) return;
      
      // 編集内容をGitHubに保存するための処理
      // ここではNetlify CMSを通じて編集を行うことを想定しています。
      // クライアントサイドから直接GitHubにコミットすることはセキュリティ上問題があるため、
      // サーバーレス関数やバックエンドを利用する必要があります。
      
      alert('修正の確定機能は現在実装されていません。Netlify CMSを使用してコンテンツを編集してください。');
    }
    
    // SortableJSの初期化
    document.addEventListener('DOMContentLoaded', function() {
      var sortable = Sortable.create(document.getElementById('editable-content'), {
        animation: 150,
        handle: '.section-title', // タイトル部分をドラッグハンドルに設定
        ghostClass: 'sortable-ghost'
      });
    });
  </script>
</body>
</html>
